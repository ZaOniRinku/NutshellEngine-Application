#include "../Core/Common/resources/ntshengn_resources_scripting.h"
#include "../Core/Common/utils/ntshengn_utils_buffer.h"

struct ClientScript : NtshEngn::Script {
	NTSHENGN_SCRIPT(ClientScript);

	void init() {
		m_cubeMesh = assetManager->createModel();
		m_cubeMesh->primitives.resize(1);
		m_cubeMesh->primitives[0].mesh.vertices = {
			{ {1.0f, 1.0f, -1.0f}, {0.0f, 1.0f, 0.0f}, {1.0f, 0.0f} },
			{ {-1.0f, 1.0f, -1.0f}, {0.0f, 1.0f, 0.0f}, {1.0f, 1.0f} },
			{ {-1.0f, 1.0f, 1.0f}, {0.0f, 1.0f, 0.0f}, {0.0f, 1.0f} },
			{ {1.0f, 1.0f, 1.0f}, {0.0f, 1.0f, 0.0f}, {0.0f, 0.0f} },
			{ {1.0f, -1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {1.0f, 0.0f} },
			{ {1.0f, 1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {1.0f, 1.0f} },
			{ {-1.0f, 1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {0.0f, 1.0f} },
			{ {-1.0f, -1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {0.0f, 0.0f} },
			{ {-1.0f, -1.0f, 1.0f}, {-1.0f, 0.0f, 0.0f}, {1.0f, 0.0f} },
			{ {-1.0f, 1.0f, 1.0f}, {-1.0f, 0.0f, 0.0f}, {1.0f, 1.0f} },
			{ {-1.0f, 1.0f, -1.0f}, {-1.0f, 0.0f, 0.0f}, {0.0f, 1.0f} },
			{ {-1.0f, -1.0f, -1.0f}, {-1.0f, 0.0f, 0.0f}, {0.0f, 0.0f} },
			{ {-1.0f, -1.0f, -1.0f}, {0.0f, -1.0f, 0.0f}, {1.0f, 0.0f} },
			{ {1.0f, -1.0f, -1.0f}, {0.0f, -1.0f, 0.0f}, {1.0f, 1.0f} },
			{ {1.0f, -1.0f, 1.0f}, {0.0f, -1.0f, 0.0f}, {0.0f, 1.0f} },
			{ {-1.0f, -1.0f, 1.0f}, {0.0f, -1.0f, 0.0f}, {0.0f, 0.0f} },
			{ {1.0f, -1.0f, -1.0f}, {1.0f, 0.0f, 0.0f}, {1.0f, 0.0f} },
			{ {1.0f, 1.0f, -1.0f}, {1.0f, 0.0f, 0.0f}, {1.0f, 1.0f} },
			{ {1.0f, 1.0f, 1.0f}, {1.0f, 0.0f, 0.0f}, {0.0f, 1.0f} },
			{ {1.0f, -1.0f, 1.0f}, {1.0f, 0.0f, 0.0f}, {0.0f, 0.0f} },
			{ {-1.0f, -1.0f, -1.0f}, {0.0f, 0.0f, -1.0f}, {1.0f, 0.0f} },
			{ {-1.0f, 1.0f, -1.0f}, {0.0f, 0.0f, -1.0f}, {1.0f, 1.0f} },
			{ {1.0f, 1.0f, -1.0f}, {0.0f, 0.0f, -1.0f}, {0.0f, 1.0f} },
			{ {1.0f, -1.0f, -1.0f}, {0.0f, 0.0f, -1.0f}, {0.0f, 0.0f} }
		};
		m_cubeMesh->primitives[0].mesh.indices = {
		0, 1, 2,
		0, 2, 3,
		4, 5, 6,
		4, 6, 7,
		8, 9, 10,
		8, 10, 11,
		12, 13, 14,
		12, 14, 15,
		16, 17, 18,
		16, 18, 19,
		20, 21, 22,
		20, 22, 23
		};

		m_cubeTexture = assetManager->createImage();
		m_cubeTexture->width = 30;
		m_cubeTexture->height = 30;
		m_cubeTexture->format = NtshEngn::ImageFormat::R8G8B8A8;
		m_cubeTexture->colorSpace = NtshEngn::ImageColorSpace::SRGB;
		m_cubeTexture->data = { 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 255, 183, 82, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255, 197, 123, 19, 255 };

		m_cubeMesh->primitives[0].material.diffuseTexture.image = m_cubeTexture;
		m_cubeMesh->primitives[0].material.diffuseTexture.imageSampler.magFilter = NtshEngn::ImageSamplerFilter::Nearest;
		m_cubeMesh->primitives[0].material.diffuseTexture.imageSampler.minFilter = NtshEngn::ImageSamplerFilter::Nearest;
		m_cubeMesh->primitives[0].material.diffuseTexture.imageSampler.mipmapFilter = NtshEngn::ImageSamplerFilter::Nearest;
		m_cubeMesh->primitives[0].material.diffuseTexture.imageSampler.anisotropyLevel = 8.0f;

		m_newRenderable.mesh = &m_cubeMesh->primitives[0].mesh;
		m_newRenderable.material = &m_cubeMesh->primitives[0].material;

		std::string serverIPAddress;
		std::cout << "Please enter the server\'s IP address: ";
		std::cin >> serverIPAddress;

		m_client = networking->createClientSocket(NtshEngn::NetworkType::UDP);
		m_client->connectToServer(serverIPAddress, 4750);

		m_client->setDataReceivedCallback([this](void* data, size_t size) {
			NtshEngn::Buffer buffer(static_cast<std::byte*>(data), size);

			uint16_t messageType;
			while (buffer.read(reinterpret_cast<std::byte*>(&messageType), sizeof(uint16_t)) != 0) {
				if (messageType == messageTypeClientConnect) {
					NtshEngn::ConnectedClientID clientID;
					buffer.read(reinterpret_cast<std::byte*>(&clientID), sizeof(NtshEngn::ConnectedClientID));

					if (clientID != m_id) {
						NtshEngn::Entity newEntity = ecs->createEntity();
						ecs->addComponent(newEntity, m_newRenderable);

						m_connectedClients[clientID] = newEntity;

						std::cout << "Client connected: " + std::to_string(clientID) << std::endl;
					}
				}
				else if (messageType == messageTypeClientDisconnect) {
					NtshEngn::ConnectedClientID clientID;
					buffer.read(reinterpret_cast<std::byte*>(&clientID), sizeof(NtshEngn::ConnectedClientID));

					ecs->destroyEntity(m_connectedClients[clientID]);

					m_connectedClients.erase(clientID);

					std::cout << "Client disconnected: " + std::to_string(clientID) << std::endl;
				}
				else if (messageType == messageTypeClientPosition) {
					NtshEngn::ConnectedClientID clientID;
					buffer.read(reinterpret_cast<std::byte*>(&clientID), sizeof(NtshEngn::ConnectedClientID));

					std::array<float, 3> entityPosition;
					buffer.read(reinterpret_cast<std::byte*>(entityPosition.data()), 3 * sizeof(float));
					if (clientID != m_id) {
						if (m_connectedClients.find(clientID) == m_connectedClients.end()) {
							NtshEngn::Entity newEntity = ecs->createEntity();
							ecs->addComponent(newEntity, m_newRenderable);

							m_connectedClients[clientID] = newEntity;
						}

						NtshEngn::Transform& entityTransform = ecs->getComponent<NtshEngn::Transform>(m_connectedClients[clientID]);
						entityTransform.position = entityPosition;
					}
				}
				else if (messageType == messageTypeClientID) {
					NtshEngn::ConnectedClientID clientID;
					buffer.read(reinterpret_cast<std::byte*>(&clientID), sizeof(NtshEngn::ConnectedClientID));

					m_id = clientID;
					NTSHENGN_CORE_INFO("I am number " + std::to_string(m_id));
				}
				else {
					NTSHENGN_CORE_WARNING("Unknown header: " + std::to_string(messageType));
				}
			}
		});
	}

	void update(double dt) {
		NTSHENGN_UNUSED(dt);
		NtshEngn::Buffer buffer;
		buffer.write(reinterpret_cast<const std::byte*>(&messageTypeClientPosition), sizeof(uint16_t));

		NtshEngn::Transform& entityTransform = ecs->getComponent<NtshEngn::Transform>(0);
		buffer.write(reinterpret_cast<const std::byte*>(entityTransform.position.data()), 3 * sizeof(float));

		m_client->sendDataToServer(buffer.getData(), buffer.getSize());
	}

	void destroy() {
	}

private:
	NtshEngn::ClientSocket* m_client;

	const uint16_t messageTypeClientConnect = 0xAE75;
	const uint16_t messageTypeClientDisconnect = 0xF2E6;
	const uint16_t messageTypeClientPosition = 0xDA32;
	const uint16_t messageTypeClientID = 0xCD83;

	std::unordered_map<NtshEngn::ConnectedClientID, NtshEngn::Entity> m_connectedClients;

	NtshEngn::ConnectedClientID m_id;

	NtshEngn::Model* m_cubeMesh;
	NtshEngn::Image* m_cubeTexture;
	NtshEngn::Renderable m_newRenderable;
};